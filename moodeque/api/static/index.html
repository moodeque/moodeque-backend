<!DOCTYPE html>
<html>
	<head>
		<title>Moodeque</title>
		<link href='http://fonts.googleapis.com/css?family=Chango' rel='stylesheet' type='text/css'>
		<link href='css/style.css' rel='stylesheet' type='text/css'>
	    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    	<link href="css/font-awesome.css" rel="stylesheet" type="text/css">
		<link href='css/dancer.css' rel='stylesheet' type='text/css'>
		<script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="logo">
			<img src="images/logo-alt.png"/> Moodeque
		</div>
		<div id="status">
			<div class="people">
				<span class="badge"><i class="icon-user"></i> <em id="people-counter"></em> users</span>
			</div>
			<h3>Mood @ <em id="venue-name"></em></h3>
			<p>
				<img src="images/excited.png"/> &nbsp; <span class="badge badge-info"><em id="excited-counter"></em>% Excited</span>
			</p>
			<p>
				<img src="images/happy.png"/> &nbsp; <span class="badge badge-success"><em id="happy-counter"></em>% Happy</span>
			</p>
			<p>
				<img src="images/bored.png"/> &nbsp; <span class="badge badge-warning"><em id="bored-counter"></em>% Bored</span>
			</p>
			<p>
				<img src="images/sad.png"/> &nbsp; <span class="badge badge-important"><em id="sad-counter"></em>% Sad</span>
			</p>
			<div id="controls" class="btn-toolbar">
				<div class="btn-group">
					<button class="btn" id="stop-song-btn"><i class="icon-stop"></i></btn>
				</div>
				<div class="btn-group">
					<button class="btn" id="play-song-btn"><i class="icon-play"></i></btn>
				</div>
			</div>
		</div>
		<div id="song">
			<div>
				<p class="title">
					<span id="song-title"></span>
				</p>
				<p class="author">
					<em id="song-author"></em>
				</p>
				<p class="album">
					<span id="song-album"></span>
				</p>
			</div>
		</div>
		<script src="js/Three.js"></script>
		<script src="js/Stats.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/dancer.js"></script>
		<script src="js/support.js"></script>
		<script src="js/beat.js"></script>
		<script src="js/adapterWebkit.js"></script>
		<script src="js/adapterMoz.js"></script>
		<script src="js/adapterFlash.js"></script>
		<script src="js/fft.js"></script>
		<script src="js/flash_detect.js"></script>
		<script src="js/dancer.fft.js"></script>
		<script src="js/scene.js"></script>
		<script src="js/player.js"></script>
		<script>
		var App = {}
		function getStatus () {
			return {
				songs: {
					current: {
						author: 'Rammstein',
						title: 'Du Hast',
						album: 'Sehnsucht',
						length: '266000',
						url: '/static/songs/duhast.mp3'
					},
					next: {
						author: 'Zircon',
						title: 'Devils Spirit',
						album: 'Zirconoid',
						length: '211000',
						url: '/static/songs/zircon_devils_spirit.mp3'
					}
				},
				venue: {
					name: 'Hackitaly',
					people: 241,
					moods: {
						excited: 30,
						happy: 195,
						bored: 11,
						sad: 5
					}
				}
			};
		}
		function setSong() {
			loadSong(App.status.songs.current.url);
			setTimeout(function(){
				switchSong();
			}, 10000);
		}
		function switchSong() {
			window.dancer.stop();
			loadSong(App.status.songs.next.url);
		}
		jQuery(document).ready(function () {
			App.status = getStatus();
			setSong();
			var people = App.status['venue']['people'];
			var excited = App.status['venue']['moods']['excited'];
			var happy = App.status['venue']['moods']['happy'];
			var bored = App.status['venue']['moods']['bored'];
			var sad = App.status['venue']['moods']['sad'];
			jQuery('#venue-name').text(App.status['venue']['name']);
			jQuery('#people-counter').text(people);
			jQuery('#excited-counter').text(Math.round(excited * 100 / people));
			jQuery('#happy-counter').text(Math.round(happy * 100 / people));
			jQuery('#bored-counter').text(Math.round(bored * 100 / people));
			jQuery('#sad-counter').text(Math.round(sad * 100 / people));
			jQuery('#song-author').text(App.status.songs.current.author);
			jQuery('#song-title').text(App.status.songs.current.title);
			jQuery('#song-album').text(App.status.songs.current.album);
		});
		</script>
	</body>
</html>
